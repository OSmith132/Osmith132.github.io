<!DOCTYPE html> 
<html lang="en-gb">

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Oliver Smith</title>
        <meta name="description" content="Oliver Smith's personal website">
        <meta name="author" content="Oliver Smith">

        <!-- Link to assets used -->
        <link rel="icon" type="image/x-icon" href="assets/leaf-icon.png">
        <script src="https://kit.fontawesome.com/7e1870387e.js" crossorigin="anonymous"></script>

        <!-- Link to fonts used -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
        

    
        <!-- Link to Stylesheet -->
        <link rel="stylesheet" href="stylesheets/main.css">

        
        <!-- Script to load header and footer functionality -->
        <script
            src="https://code.jquery.com/jquery-3.3.1.js"
            integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
            crossorigin="anonymous">
        </script>

        

        <script> 
        $(function(){
        $("#header").load("header.html"); 
        $("#footer").load("footer.html"); 
        });
        </script> 

    </head>


    <body>
        <!-- Header -->
        <div id="header"></div>

        <!-- Main  -->
        <main>

                
                <!-- Title -->
                <div class="project-title">
                    <h2>FeedTrac</h2>
                </div>

                <!-- <div class="github-link">
                    <div class="github-card" data-github="OSmith132/FeedTrac" data-target="blank" data-width="100%" data-height="50%" data-theme="default"></div>
                    <script src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>
                </div> -->

                
                
                
                <div class="github-card-container smallFadeInBottom">
                  <div class="github-card" onclick="window.open('https://github.com/OSmith132/FeedTrac', '_blank');">
                    <div class="card-header">
                      <img id="profile-pic" src="" onerror="this.onerror=null; this.src='assets/icons/warning-icon.png';">
                      <div class="text-container">
                        <h2><a href="https://github.com/OSmith132/FeedTrac" target="_blank">FeedTrac</a></h2>
                        <p><a href="https://github.com/OSmith132" target="_blank">OSmith132</a></p>
                      </div>
                    </div>
                    <p id="description" class="description">Description: Loading...</p>
                    <div class="languages ">
                      <strong>Languages: </strong> <span id="languages">...</span>
                    </div>
                    <div class="stats">
                      <div class="stat-item">
                        <strong>Commits: </strong> <span id="commits">...</span>
                      </div>
                      <div class="stat-item">
                        <strong>Stars: </strong> <span id="stars">...</span>
                      </div>
                      <div class="stat-item">
                        <strong>Forks: </strong> <span id="forks">...</span>
                      </div>
                    </div>
                  </div>
                </div>
                
              
                


                <script>

                  const token = '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'; // This token can only view repos and github was being a pain. Don't judge me too harshly please.
                
            
                  // Fetch repository information
                  fetch(`https://api.github.com/repos/OSmith132/FeedTrac`, {
                    headers: {
                      Authorization: `token ${token}` 
                    }
                  })
                  .then(response => response.json())
                  .then(data => {
                    document.getElementById('description').innerText = ` ${data.description || 'No description provided.'}`;
                    document.getElementById('stars').innerText = data.stargazers_count;
                    document.getElementById('forks').innerText = data.forks_count; 
                  })
                  .catch(error => {
                    console.error('Error fetching repository data:', error);
                  });

             
                  fetch(`https://api.github.com/users/OSmith132`, {
                    headers: {
                      Authorization: `token ${token}` 
                    }
                  })
                  .then(response => response.json())
                  .then(data => {
                    document.getElementById('profile-pic').src = data.avatar_url;
                  })
                  .catch(error => {
                    console.error('Error fetching user profile data:', error);
                  });

              
                  async function fetchTotalCommits() {
                    let totalCommits = 0;
                    let page = 1;
                    const perPage = 100; 

                    while (true) {
                      const response = await fetch(`https://api.github.com/repos/OSmith132/FeedTrac/commits?per_page=${perPage}&page=${page}`, {
                        headers: {
                          Authorization: `token ${token}` 
                        }
                      });

                      if (!response.ok) {
                        console.error('Error fetching commits data:', response.statusText);
                        document.getElementById('commits').innerText = 'Error fetching commits';
                        return;
                      }

                      const data = await response.json();
                      totalCommits += data.length;

            
                      if (data.length < perPage) {
                        break;
                      }

                      page++;
                    }

                    document.getElementById('commits').innerText = totalCommits;
                  }

              
                  fetchTotalCommits();


                  // Fetch languages used in the repository
                  fetch(`https://api.github.com/repos/OSmith132/FeedTrac/languages`, {
                    headers: {
                      Authorization: `token ${token}` // Use the token here
                    }
                  })
                  .then(response => response.json())
                  .then(data => {
                    // Convert the object to an array of entries and sort it by usage
                    const sortedLanguages = Object.entries(data)
                      .sort((a, b) => b[1] - a[1]) // Sort by usage
                      .slice(0, 3); // Get the top 3

                    // Map to a string format
                    const languages = sortedLanguages.map(lang => lang[0]).join(', ');
                    document.getElementById('languages').innerText = languages || 'No languages found';
                  })
                  .catch(error => {
                    console.error('Error fetching languages data:', error);
                    document.getElementById('languages').innerText = 'Error fetching languages';
                  });
                  </script>
                
                
                
                

















                


                <!-- PDF Viewer -->
                <div class="pdfViewerContainer">
                    
                    <button class="toggleButton">
                        FeedTrac Project Documentation
                        <i class="fas fa-chevron-down arrow"></i> <!-- Down arrow initially -->
                    </button>
                    <div class="pdfViewer">
                        <embed src="assets/Documentation/Team_Software_engineering.pdf#toolbar=0&navpanes=0&scrollbar=0" style="height: 100vh; width: 80vw;" />
                    </div>
                </div>



        </main>
        
        <!-- Footer -->
        <div id="footer"></div>

    </body>

    

</html>
